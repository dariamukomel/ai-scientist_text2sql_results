SELECT COUNT(*) FROM vacancies;
SELECT work_location, MAX(salary_to) AS max_salary FROM vacancies WHERE work_location IN ('Москва', 'Омск', 'Екатеринбург') AND date_added >= '2022-10-01' AND date_added < '2022-11-01' GROUP BY work_location;

SELECT COUNT(*)  FROM vacancies  WHERE name = 'Java разработчик';
SELECT COUNT(*) FROM vacancies WHERE name = 'Python разработчик' AND work_location = 'Петербург';
SELECT *  FROM vacancies  WHERE name = 'C++ разработчик' AND salary_from > 200000;
SELECT * FROM vacancies WHERE name = 'Java разработчик' AND salary_from > 150000 AND schedule_type = 'remote';
SELECT COUNT(*)  FROM vacancies  WHERE salary_currency = 'RUR';
SELECT c.city_name, COUNT(v.vacancy_id) AS num_vacancies FROM vacancies v JOIN companies co ON v.company_id = co.company_id JOIN cities c ON co.company_city = c.city_name WHERE v.name LIKE '%Python разработчик%' GROUP BY c.city_name ORDER BY num_vacancies DESC LIMIT 1;
SELECT COUNT(*)  FROM vacancies  WHERE salary_from IS NULL AND salary_to IS NULL;
SELECT salary_currency, MAX(salary_to) FROM vacancies GROUP BY salary_currency;
SELECT vacancies.* FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE companies.company_city = 'Омск' AND vacancies.schedule_type = 'mixed';
SELECT DISTINCT direction FROM vacancies;
SELECT AVG(salary_from) AS average_salary_from FROM vacancies WHERE work_location = 'Санкт-Петербург';
SELECT MAX(salary_to) AS max_salary FROM vacancies WHERE work_location = 'Москва';
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.name = 'ООО Рога и Копыта' AND v.salary_from BETWEEN 50000 AND 100000;
SELECT * FROM vacancies WHERE date_added = '2020-04-01';
SELECT COUNT(*)  FROM vacancies  WHERE date_added > '2021-01-01';
SELECT *  FROM vacancies  WHERE salary_from >= 50000  AND salary_to <= 100000  AND salary_currency = 'RUR';
SELECT DISTINCT department_name FROM departments;
SELECT COUNT(*)  FROM vacancies  WHERE schedule_type = 'flexible';
SELECT * FROM vacancies WHERE salary_currency = 'USD';
SELECT COUNT(*) FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE companies.name = 'ООО Ромашка';
SELECT *  FROM vacancies  WHERE date_added = '2021-03-05';
SELECT DISTINCT work_location  FROM vacancies  WHERE schedule_type = 'remote';
SELECT MAX(salary_to) AS max_salary_to FROM vacancies;
SELECT vacancies.*  FROM vacancies  JOIN companies ON vacancies.company_id = companies.company_id  WHERE companies.company_street = 'Большая Морская';
SELECT COUNT(*) FROM vacancies WHERE level = 'middle' AND salary_from > 100000;
SELECT vacancies.salary_currency, COUNT(*) AS count_vacancies FROM vacancies GROUP BY vacancies.salary_currency ORDER BY count_vacancies DESC LIMIT 1;
SELECT COUNT(DISTINCT(company_id)) FROM vacancies WHERE schedule_type = 'flexible';
SELECT * FROM vacancies WHERE work_location = 'Санкт-Петербург' AND date_added >= '2021-02-01' AND date_added < '2021-03-01';
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.company_city = 'Омск' AND v.salary_currency = 'USD';
SELECT COUNT(DISTINCT(companies.name)) FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE vacancies.schedule_type = 'fullDay';
SELECT vacancies.salary_currency, COUNT(*) AS number_of_vacancies FROM vacancies GROUP BY vacancies.salary_currency;
SELECT COUNT(*)  FROM vacancies  WHERE schedule_type = 'remote';
SELECT c.name AS employer_name, COUNT(v.vacancy_id) AS number_of_vacancies FROM companies c JOIN vacancies v ON c.company_id = v.company_id WHERE c.company_city = 'Москва' GROUP BY c.name ORDER BY number_of_vacancies DESC LIMIT 5;
SELECT vacancies.work_location, COUNT(*) as num_vacancies FROM vacancies GROUP BY vacancies.work_location ORDER BY num_vacancies DESC LIMIT 1;
SELECT vacancies.name  FROM vacancies  WHERE vacancies.work_location = 'Москва'  ORDER BY vacancies.salary_to DESC  LIMIT 5;
SELECT *  FROM vacancies  ORDER BY date_added DESC  LIMIT 10;
SELECT COUNT(*)  FROM vacancies  WHERE work_location = 'Екатеринбург'  AND date_added >= '2022-01-01'  AND date_added < '2022-02-01';
SELECT COUNT(*)  FROM vacancies  WHERE direction = 'it';
SELECT COUNT(*) FROM vacancies WHERE level = 'senior' AND direction = 'frontend';
SELECT COUNT(*)  FROM vacancies  WHERE company_id = 5;
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.name = 'Yandex';
SELECT name, work_location, salary_from, salary_to FROM vacancies WHERE salary_currency = 'USD' AND (salary_from > 5000 OR salary_to > 5000);
SELECT COUNT(*)  FROM vacancies  WHERE date_added = CURRENT_DATE;
SELECT AVG(salary_from) AS average_salary_in_usd FROM vacancies WHERE salary_currency = 'USD';
SELECT DISTINCT vacancies.name FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE companies.name = 'ООО Ништяк';
SELECT * FROM vacancies WHERE date_added > '2022-01-01';
SELECT * FROM vacancies ORDER BY salary_to DESC LIMIT 10;
SELECT departments.*  FROM vacancies  JOIN departments ON vacancies.department_id = departments.department_id  WHERE vacancies.vacancy_id = 3;
SELECT vacancies.* FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE companies.name = 'Yandex' AND vacancies.direction = 'backend';
SELECT DISTINCT companies.name AS CompanyName FROM companies JOIN vacancies ON companies.company_id = vacancies.company_id WHERE companies.company_city = 'Москва' AND vacancies.level = 'senior';
SELECT departments.department_id, departments.department_name FROM departments JOIN companies ON departments.company_id = companies.company_id WHERE companies.name = 'ООО Ништяк';
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE v.schedule_type = 'remote' AND c.company_city = 'Москва';
SELECT COUNT(vacancies.vacancy_id) FROM vacancies JOIN departments ON vacancies.department_id = departments.department_id JOIN companies ON departments.company_id = companies.company_id WHERE companies.name = 'ООО Рога и Копыта' AND departments.department_name = 'finance';
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.company_city = 'Санкт-Петербург' AND v.level = 'middle' AND v.date_added >= '2022-01-01' AND v.date_added < '2023-01-01';
SELECT AVG(vacancies.salary_from) AS average_salary_from FROM vacancies JOIN companies ON vacancies.company_id = companies.company_id WHERE companies.company_city = 'Екатеринбург';
SELECT COUNT(*) FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.company_street LIKE '%Ленина%';
SELECT v.vacancy_id, c.name AS company_name, v.name AS job_title FROM vacancies v JOIN companies c ON v.company_id = c.company_id WHERE c.company_city = 'Санкт-Петербург' AND v.direction = 'bigdata';
